

DECLARE CACHE SHARED ROW ;
DECLARE TYPE,TIMECOUNT EXTERNAL CHARACTER;
CREATE COMPUTE MODULE SHARED_VARIBALE_FLOW_Create
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN



		IF CACHE.DATA.Item IS NOT NULL AND EXTRACT(DAY FROM CACHE.DATA.TIME) = EXTRACT(DAY FROM CURRENT_TIMESTAMP) THEN
			CASE TYPE
				

			WHEN 'HOUR' THEN
				IF EXTRACT(HOUR FROM CURRENT_TIMESTAMP) - EXTRACT(HOUR FROM CACHE.DATA.TIME)>TIMECOUNT THEN
					CALL STORE_CHACHE();
				END IF;
			WHEN 'MINUTE' THEN
				IF EXTRACT(MINUTE FROM CURRENT_TIMESTAMP) - EXTRACT(MINUTE FROM CACHE.DATA.TIME) > TIMECOUNT THEN
					CALL STORE_CHACHE();
				END IF;
			END CASE;
		ELSE
			CALL STORE_CHACHE();
		END IF;


		RETURN TRUE;
	END;
END MODULE;



CREATE PROCEDURE STORE_CHACHE() BEGIN

	SET CACHE.DATA.DATE=CURRENT_DATE;
	SET CACHE.DATA.TIME=CURRENT_TIMESTAMP;
	SET CACHE.DATA.Item[1]='test';
	SET CACHE.DATA.flag[1]='1';
	SET CACHE.DATA.Item[2]='test';
	SET CACHE.DATA.flag[2]='1';
	SET CACHE.DATA.Item[3]='test';
	SET CACHE.DATA.flag[3]='1';
	SET CACHE.DATA.Item[4]='test';
	SET CACHE.DATA.flag[4]='1';
	SET CACHE.DATA.Item[5]='test';
	SET CACHE.DATA.flag[5]='1';
	SET CACHE.DATA.Item[6]='test';
	SET CACHE.DATA.flag[6]='1';
	SET CACHE.DATA.Item[7]='test';
	SET CACHE.DATA.flag[7]='1';
	SET CACHE.DATA.Item[8]='test';
	SET CACHE.DATA.flag[8]='1';



END;


CREATE COMPUTE MODULE SHARED_VARIBALE_USE
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN


		DECLARE VAR ROW; --Declare a normal variable
		SET VAR = CACHE; --Assign Shared variable value to Normal Variable

		SET OutputRoot.XMLNSC.Root.Data = VAR;


	END;
END MODULE;